<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Submit Project - CODENET</title>
  <link rel="stylesheet" href="codenet.css" />
  <link href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" rel="stylesheet" />
  <!-- API Client -->
  <script src="api.js"></script>
</head>
<body>

<header class="top-menu">
    <ul>
      <li><img src="C.webp" alt="brand logo" class="logo" /></li>
      <li><a href="codenet.html" class="nav-link">HOME</a></li>
      <li><a href="codelibrary.html" class="nav-link">CODE LIBRARY</a></li>
      <li><a href="submitproject.html" class="nav-link">SUBMIT PROJECT</a></li>
      <li><a href ="aboutus.html" class="nav-link">ABOUT US</a></li>
    </ul>
    <div class="header-right">
      <div id="auth-status">
        <a href="login.html" class="auth-btn">LOGIN / SIGN UP</a>
      </div>
      <a href="mailto:binupanuransith@gmail.com" class="contact">CONTACT US</a>
    </div>
    <div class="hamburger" onclick="toggleMenu()">&#9776;</div>
  </header>

  
    <section class="middle-log">
    <div class="content-log">
        <form class="submit-form" enctype="multipart/form-data">
          <h2>Submit Your Project</h2>
          
          <label for="title">Project Title *</label>
          <input type="text" id="title" name="title" required />

          <label for="subtitle">Subtitle (Optional)</label>
          <input type="text" id="subtitle" name="subtitle" />

          <label for="description">Brief Description *</label>
          <textarea id="description" name="description" rows="4" required maxlength="5000" placeholder="Describe your project (1-5000 characters)"></textarea>
          <small id="char-count">0/5000 characters</small>

          <label for="media">Upload Photos/Videos</label>
          <input type="file" id="media" name="media" accept="image/*,video/*" multiple />
          <small>Please upload clear, relevant photos/videos that describe your project</small>

          <div id="file-preview"></div>

          <input type="submit" value="Submit Project" id="submit-btn" />
          <div id="submission-status"></div>
        </form>
    </div>
  </section>



    <!-- FOOTER -->
  <footer class="footer">
    <div class="footer-left">
      <ul>
        <li>
          <img src="C.webp" alt="logo" style="height: 50px; width: 150px;" />
        </li>
        <li>
          <img src="download.png" alt="Facebook" style="height: 50px; width: 50px; border-radius: 100%;" />
            <img src="download (1).png" alt="Instagram" style="height: 50px; width: 50px; border-radius: 100%;" />
          </a>
        </li>
      </ul>
    </div>
    <div class="footer-right">
      <ul>
        <li>
          <img src="images (1).png" alt="telephone" style="height: 30px; width: 30px; padding-right: 20px; padding-top: 10px;" />
          <p>+94-77-483-7197</p>
        </li>
        <li>
          <img src="images.png" alt="mail" style="height: 30px; width: 30px; padding-right: 20px; padding-top: 10px;" />
          <p><a href="mailto:binupanuransith@gmail.com"> binupanuransith@gmail.com</a></p>
        </li>
      </ul>
    </div>

    <div class="footer-bottom">
      <p>&copy; 2025 CODENET</p>
    </div>
  </footer>

  <script>
    // Initialize page without authentication for now
    window.addEventListener('load', function() {
      console.log('Submit project page loaded');
      setupFormHandlers();
    });

    // Mock authentication status for development
    function updateAuthStatus() {
      const authStatus = document.getElementById('auth-status');
      // For development, show login link
      authStatus.innerHTML = '<a href="login.html" class="auth-btn">LOGIN / SIGN UP</a>';
    }

    // Mock authentication check for development
    function checkAuthentication() {
      // For development, allow all users to submit projects
      console.log('Authentication check: Development mode - allowing all submissions');
      return true;
    }

    // Mock logout function
    function logout() {
      console.log('Logout clicked - development mode');
      alert('Logout functionality will be implemented with authentication');
    }

    // Setup form handlers
    function setupFormHandlers() {
      // Character counter for description
      const descriptionField = document.getElementById('description');
      const charCount = document.getElementById('char-count');
      
      if (descriptionField && charCount) {
        descriptionField.addEventListener('input', function() {
          const remaining = 5000 - this.value.length;
          charCount.textContent = `${this.value.length}/5000 characters`;
          charCount.style.color = remaining < 100 ? 'red' : 'inherit';
        });
      }

      // File preview
      const fileInput = document.getElementById('media');
      const filePreview = document.getElementById('file-preview');
      
      if (fileInput && filePreview) {
        fileInput.addEventListener('change', function() {
          filePreview.innerHTML = '';
          if (this.files.length > 0) {
            for (let i = 0; i < this.files.length; i++) {
              const file = this.files[i];
              const fileDiv = document.createElement('div');
              fileDiv.className = 'file-preview-item';
              fileDiv.innerHTML = `
                <span>${file.name}</span>
                <small>(${(file.size / 1024 / 1024).toFixed(2)} MB)</small>
              `;
              filePreview.appendChild(fileDiv);
            }
          }
        });
      }

      // Form submission
      const form = document.querySelector('.submit-form');
      if (form) {
        form.addEventListener('submit', handleFormSubmission);
      }
    }

    // Handle form submission
    async function handleFormSubmission(event) {
      event.preventDefault();
      
      const submitBtn = document.getElementById('submit-btn');
      const statusDiv = document.getElementById('submission-status');
      
      // Disable submit button
      submitBtn.disabled = true;
      submitBtn.value = 'Submitting...';
      
      try {
        // Get form data
        const formData = new FormData();
        const projectData = {
          title: document.getElementById('title').value,
          subtitle: document.getElementById('subtitle').value,
          description: document.getElementById('description').value
        };
        
        formData.append('project', new Blob([JSON.stringify(projectData)], {
          type: 'application/json'
        }));
        
        // Add media files
        const mediaFiles = document.getElementById('media').files;
        for (let i = 0; i < mediaFiles.length; i++) {
          formData.append('media', mediaFiles[i]);
        }
        
        // Submit to API
        const api = new CodenetAPI();
        const response = await api.createProject(formData);
        
        // Show success message
        statusDiv.innerHTML = '<div class="success-message">Project submitted successfully! It will be reviewed by our team.</div>';
        form.reset();
        document.getElementById('file-preview').innerHTML = '';
        document.getElementById('char-count').textContent = '0/5000 characters';
        
      } catch (error) {
        console.error('Submission error:', error);
        statusDiv.innerHTML = `<div class="error-message">Error submitting project: ${error.message}</div>`;
      } finally {
        // Re-enable submit button
        submitBtn.disabled = false;
        submitBtn.value = 'Submit Project';
      }
    }

    // Mobile menu toggle
    function toggleMenu() {
      const menu = document.querySelector('.top-menu ul');
      menu.classList.toggle('active');
    }
  </script>
</body>
</html>
